{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///home/mskhairi/Rea-Estate_app/src/server/db.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client'\n\nconst prismaClientSingleton = () => {\n  return new PrismaClient()\n}\n\ndeclare global {\n  var prismaGlobal: undefined | ReturnType<typeof prismaClientSingleton>\n}\n\nconst prisma = globalThis.prismaGlobal ?? prismaClientSingleton()\n\nexport default prisma\n\nif (process.env.NODE_ENV !== 'production') globalThis.prismaGlobal = prisma\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,wBAAwB;IAC5B,OAAO,IAAI,6IAAY;AACzB;AAMA,MAAM,SAAS,WAAW,YAAY,IAAI;uCAE3B;AAEf,wCAA2C,WAAW,YAAY,GAAG"}},
    {"offset": {"line": 74, "column": 0}, "map": {"version":3,"sources":["file:///home/mskhairi/Rea-Estate_app/src/app/api/auth/login/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server'\nimport bcrypt from 'bcryptjs'\nimport { sign } from 'hono/jwt'\nimport prisma from '@/server/db'\n\nconst JWT_SECRET = process.env.JWT_SECRET || 'supersecret'\n\nexport async function POST(request: NextRequest) {\n  try {\n    const body = await request.json()\n    const { email, password } = body\n\n    console.log('[AUTH] Login attempt for:', email)\n\n    if (!email || !password) {\n      return NextResponse.json({ error: 'Email and password required' }, { status: 400 })\n    }\n\n    const user = await prisma.user.findUnique({ where: { email } })\n    \n    if (!user) {\n      console.log('[AUTH] User not found:', email)\n      return NextResponse.json({ error: 'Invalid credentials' }, { status: 401 })\n    }\n\n    console.log('[AUTH] User found, verifying password')\n    const isValid = await bcrypt.compare(password, user.password)\n    \n    if (!isValid) {\n      console.log('[AUTH] Invalid password for:', email)\n      return NextResponse.json({ error: 'Invalid credentials' }, { status: 401 })\n    }\n\n    const payload = {\n      id: user.id,\n      email: user.email,\n      role: user.role,\n      exp: Math.floor(Date.now() / 1000) + 60 * 60 * 24, // 1 day\n    }\n\n    const token = await sign(payload, JWT_SECRET)\n\n    console.log('[AUTH] Login successful for:', email)\n    \n    const response = NextResponse.json({ \n      user: { \n        id: user.id, \n        email: user.email, \n        role: user.role, \n        name: user.name \n      } \n    })\n\n    response.cookies.set('token', token, {\n      httpOnly: true,\n      secure: process.env.NODE_ENV === 'production',\n      sameSite: 'strict',\n      path: '/',\n      maxAge: 60 * 60 * 24,\n    })\n\n    return response\n  } catch (error) {\n    console.error('[AUTH] Login error:', error)\n    return NextResponse.json(\n      { error: 'Internal server error', details: error instanceof Error ? error.message : 'Unknown error' },\n      { status: 500 }\n    )\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AAAA;AACA;;;;;AAEA,MAAM,aAAa,QAAQ,GAAG,CAAC,UAAU,IAAI;AAEtC,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG;QAE5B,QAAQ,GAAG,CAAC,6BAA6B;QAEzC,IAAI,CAAC,SAAS,CAAC,UAAU;YACvB,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAA8B,GAAG;gBAAE,QAAQ;YAAI;QACnF;QAEA,MAAM,OAAO,MAAM,gIAAM,CAAC,IAAI,CAAC,UAAU,CAAC;YAAE,OAAO;gBAAE;YAAM;QAAE;QAE7D,IAAI,CAAC,MAAM;YACT,QAAQ,GAAG,CAAC,0BAA0B;YACtC,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAsB,GAAG;gBAAE,QAAQ;YAAI;QAC3E;QAEA,QAAQ,GAAG,CAAC;QACZ,MAAM,UAAU,MAAM,8IAAM,CAAC,OAAO,CAAC,UAAU,KAAK,QAAQ;QAE5D,IAAI,CAAC,SAAS;YACZ,QAAQ,GAAG,CAAC,gCAAgC;YAC5C,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAsB,GAAG;gBAAE,QAAQ;YAAI;QAC3E;QAEA,MAAM,UAAU;YACd,IAAI,KAAK,EAAE;YACX,OAAO,KAAK,KAAK;YACjB,MAAM,KAAK,IAAI;YACf,KAAK,KAAK,KAAK,CAAC,KAAK,GAAG,KAAK,QAAQ,KAAK,KAAK;QACjD;QAEA,MAAM,QAAQ,MAAM,IAAA,kKAAI,EAAC,SAAS;QAElC,QAAQ,GAAG,CAAC,gCAAgC;QAE5C,MAAM,WAAW,gJAAY,CAAC,IAAI,CAAC;YACjC,MAAM;gBACJ,IAAI,KAAK,EAAE;gBACX,OAAO,KAAK,KAAK;gBACjB,MAAM,KAAK,IAAI;gBACf,MAAM,KAAK,IAAI;YACjB;QACF;QAEA,SAAS,OAAO,CAAC,GAAG,CAAC,SAAS,OAAO;YACnC,UAAU;YACV,QAAQ,oDAAyB;YACjC,UAAU;YACV,MAAM;YACN,QAAQ,KAAK,KAAK;QACpB;QAEA,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,uBAAuB;QACrC,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;YAAyB,SAAS,iBAAiB,QAAQ,MAAM,OAAO,GAAG;QAAgB,GACpG;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}